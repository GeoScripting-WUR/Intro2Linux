---
title: "Getting started with Linux (OS-GEOLive)"
subtitle: "The terminal, R, and Python"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    theme: united
    toc: yes
    toc_depth: 4
    number_sections: true
---

# Today in the morning

Read and do the below described tutorial

# Today's Learning objectives

- Knowing what Linux is (presentation by Allard De Wit)
- Know how to use the **terminal**!!!
- Getting comfortable within OSGEO-Linux environment
    - Launching Rstudio and using Git
    - Running and writing Python script from the QGIS Python Console

# A simple intro to the terminal

## What is the terminal

### Bash? 

### The terminal on Linux, Mac, or Windows
Is not the "Terminator" but something really powerfull. The terminal is the engine behind linux and mac and can also be installed on Windows via a program called `Cygwin`.

[Is the terminal in Mac and Linux the same](https://stackoverflow.com/questions/8051145/is-the-terminal-in-mac-and-linux-the-same)

## Using the terminal

### Basic commands

Most common commands:
- cd
- pwd
- ls
- cp and mv
- etc.

```{r, engine='bash', results='hide'}
cd
```

```{r, engine='bash', results='hide'}
pwd
```

List files

```{r, engine='bash'}
ls
```

```{r, engine='bash'}
ls -lht
```

How to use it:

```{r, engine='bash', results='hide', eval=FALSE}
## Where am I?
pwd
 
## List the contents of the current directory
ls
ls -l
 
# Change the current directory to Videos
cd Videos
pwd
```

### Scripting in the terminal

`Bash` is primarily a scripting language, so it would be a crime not to talk about scripting. Let's dive straight in with a `bash` script. More precisely the infamous "Hello World" script. You can create a bash script by opening your favorite text editor to edit your script and then saving it (typically the `.sh` file extension is used for your reference, but is not necessary. In our examples, we will be using the `.sh` extension).

So let's get started. First, create a `Bash` folder within your R project folder (like you have your `R` folder). Within this folder create a simple text file using Rstudio -> New File -> Text File and call this file: `HelloWorld.sh` add the following text and save.

```{r, eval =FALSE, engine='bash'}
 #!/bin/bash         
echo "Hello, World"
```

The first line of the script just defines which interpreter to use. NOTE: There is no leading whitespace before #!/bin/bash. That's it, simple as that!'.

Second, to run a bash script you first have to have the correct file permissions. We do this with `chmod` command in terminal (change mode) as follows:
```{r, eval=FALSE}
chmod a+x /where/i/saved/it/HelloWorld.sh   #Gives everyone execute permissions
```

Go to the terminal via the `Git` tab in `Rstudio` and click on `Shell...` and from there make sure you go to the `Bash` folder you created and you can excute the following line (see output of the following script below behind `##`:

```{r, eval=FALSE, engine='bash'}
echo "Go to the Bash folder"
cd Bash
echo "Check that the file is there using the ls command:"
ls
echo "Then change the permissions:"
chmod a+x HelloWorld.sh
echo "We can now run our first `Bash script`:"
./HelloWorld.sh
```

`## Hello, World!!!`

Hopefully you should have seen it print Hello, World!!! onto your screen. If so well done! That is your first `Bash` script.

**Question**: why do we add `./` in front of the Bash script?

### Using the GDAL library from the terminal

***Do you know who Frank Warmerdam is?*** 

- Check the the FWtools: 
    - http://fwtools.maptools.org/
    - FWTools is a set of Open Source GIS binaries for Windows (win32) and Linux (x86 32bit) systems produced
- He's is the man behind GDAL and is now working at [Planet Labs](https://www.planet.com/).

Now via the terminal we can acces GDAL directly!!! E.g. we can check out what the current version of GDAL is that is installed on our Linux OS:

Let's download a file from [Lesson 4 and Raster object manipulations](https://geoscripting-wur.github.io/IntroToRaster/#raster-objects-manipulations):

Download the `gewata.zip` file from Github ([link](https://github.com/GeoScripting-WUR/IntroToRaster/raw/gh-pages/data/gewata.zip)) and unzip in the data folder.

```{r, engine='bash'}
echo "the current GDAL version is:"
gdal-config --version
```

Using gdalinfo:

```{r, engine='bash'}
cd data
ls *.tif
```

```{r, engine='bash', eval=FALSE}
gdalinfo -nomd -norat -noct LE71700552001036SGS00_SR_Gewata_INT1U.tif
```

Now let's calculate the NDVI via GDAL terminal

```{r, engine='bash'}
cd data
cp LE71700552001036SGS00_SR_Gewata_INT1U.tif input.tif
echo "* all files in the directory"
ls
echo "* now apply gdal_calc: Command line raster calculator with numpy syntax"
gdal_calc.py -A input.tif --A_band=4 -B input.tif --B_band=3  --outfile=ndvi.tif  --calc="(A.astype(float)-B)/(A.astype(float)+B)" --type='Float32' --co="COMPRESS=LZW"
echo "* remove the input temporary file"
rm input.tif
```

```{r, engine='bash', results='hide'}
cd data
echo "* list all files"
ls -lht
echo "* histogram statistics"
gdalinfo -hist -stats ndvi.tif
```

More info here on the power of GDAL via the terminal:
http://www.gdal.org/

### Excercise

Try to write a shell script that looks at the difference between the two file provided by Loic.






See the following tutorial for Geeks! (Warning!: Now you are risking to become a Geek or even computer freak yourself)

- http://www.howtogeek.com/140679/beginner-geek-how-to-start-using-the-linux-terminal/
- http://www.howtogeek.com/howto/42980/the-beginners-guide-to-nano-the-linux-command-line-text-editor/
- http://linuxcommand.org/lc3_learning_the_shell.php
Try to install the following program on Linux

Introduction to use the terminal on Mac//very similar commands on OSGEO-Linux

- http://computers.tutsplus.com/tutorials/navigating-the-terminal-a-gentle-introduction--mac-3855
- http://blog.teamtreehouse.com/introduction-to-the-mac-os-x-command-line


# R and Rstudio within Linux

# Python within Linux

- Via QGIS -> Plug-inns -> Python Console
- Choose you own preferred editor for Python scripts
    - Gedit as simple but good text editor
    - Eric
    - Spyder

## More information

- More information
    * http://www.cyberciti.biz/faq/pwd-linux-unix-command-examples/
    * 
- [An overview of terminal commands](http://beginlinux.com/twitter/1094-the-beginners-guide-to-the-ubuntu-terminal)

